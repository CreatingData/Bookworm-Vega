<script src="output.js"></script>
<!--> Below to enforce rebuild in webpack dev mode. <-->
<script src="d3.v4.min.js"></script>

<h2>Bookworm API Sandbox</h2>

This is an example of transpiling from the old Bookworm visualization
API to Vegalite. You can plot the query below, or edit it. (I'll some
examples, eventually.) Once you click "draw plot," it will place a
query to the Hathi Trust server and draw the vega spec in the screen
below.

Good uses of this library will provide more granular support than
editing the API call directly, as here.

<h3>Other queries</h3>

<div id=other></div>

<textarea rows=12 cols=80>
</textarea>

<br>

<button>Draw Plot</button>

<br>

<script>

  var input = d3.select("textarea")

  var worm= new bookworm.default("#canvas", 600, 400)

  d3.select("button").on("click", function() {
     worm.plotAPI(JSON.parse(input.node().value))
  })

  d3.json("default_searches.json", function(others) {
  const buttons = d3.select("#other").selectAll("button").data(others).enter()

  buttons.append("button")
  .text(d => d.name)
  .on("click", d => input.node().value = JSON.stringify(d.query, null, 2))
  
  
  input.node().value = JSON.stringify(others[0].query, null, 2)
  
  worm.plotAPI(JSON.parse(input.node().value))
  })
  

</script>


<div id="canvas"></div>
